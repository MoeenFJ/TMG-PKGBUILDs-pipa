pkgname="qbootctl"
pkgdesc="Qualcomm bootctl HAL for Linux"
pkgver=0.2.2
pkgrel=1
arch=("aarch64")
url="https://github.com/linux-msm/qbootctl"
license=("GPL3")
depends=("glibc" "zlib" "gcc-libs")
makedepends=("git" "meson" "gcc")
source=("git+https://github.com/linux-msm/qbootctl.git"
		"qbootctl.service")
sha256sums=("SKIP"
			"d90da17a08af1dc0bc141b802431dd74e38e93adda3ac29edb9f7fffe3254bab")

build() {
	arch-meson "$pkgname" build
	meson compile -C build
}

package() {
	meson install -C build --destdir "$pkgdir"
	install -Dm644 "$pkgname/LICENSE" "$pkgdir"/usr/share/licenses/$pkgname/LICENSE
	install -Dm644 qbootctl.service "$pkgdir"/usr/lib/systemd/system/qbootctl.service

	# Enable the service aswell
	install -d "$pkgdir/etc/systemd/system/multi-user.target.wants"
	ln -s /usr/lib/systemd/system/qbootctl.service \
	      "$pkgdir/etc/systemd/system/multi-user.target.wants/qbootctl.service"
	
}
